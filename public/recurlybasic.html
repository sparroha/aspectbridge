<!DOCTYPE html>
<html lang="en">
  <head>
    <title>demo | react-recurly</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <link rel="stylesheet" href="https://js.recurly.com/v4/recurly.css" />
    <script src="https://js.recurly.com/v4/recurly.js"></script>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <form>
        <lable>AccountID</lable>
        <input type="text" data-recurly="actid">
        <div data-recurly="card"></div>
        <input type="hidden" name="token" data-recurly="token">
        <button>submit</button>
    </form>
  </body>
  <script>
    const recurly = new window.recurly.Recurly({
      publicKey: process.env.RECURLY_PUBLIC_KEY
    });
    recurly.configure(process.env.RECURLY_PUBLIC_KEY);
    const form = document.querySelector('form');
    form.addEventListener('submit', function (event) {
      event.preventDefault();
      recurly.token(form, function (err, token) {
        if (err) {
          console.error(err);
        } else {
          console.log(token);
          form.querySelector('[name="recurly-token"]').value = token.id;
          form.submit();
        }
      });
    });
    
    let purchaseReq = {
    currency: 'USD',
    account: {
        code: accountCode,
        billingInfo: {
        tokenId: rjsTokenId
        }
    },
    subscriptions: [
        { planCode: planCode },
    ]
    }

    let invoiceCollection = await client.createPurchase(purchaseReq)
    </script>
</html>